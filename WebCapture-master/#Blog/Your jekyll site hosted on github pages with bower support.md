# Your jekyll site hosted on github pages with bower support

_Captured: 2016-12-21 at 20:34 from [www.aymerick.com](http://www.aymerick.com/2014/07/22/jekyll-github-pages-bower-bootstrap.html)_

This blog post is a tutorial to setup a jekyll site with [bootstrap](http://getbootstrap.com) installed thanks to [bower](http://bower.io/), and fully hosted on github pages.

[Jekyll](http://jekyllrb.com/) support on github pages is great, but there are some limitations that prevent me from using it:

  * I want to use [bower](http://bower.io/) to manage dependencies, and without pushing the bower components directory to git
  * I want to be able to use custom jekyll plugins

So I prefer to directly push the generated site on github pages.

Code for this tutorial is available here: <https://github.com/aymerick/jekyll-example>

Result website is here: <http://jekyll-example.aymerick.com>

Websites I built with that setup:

### Setup the master branch

**WARNING:** This tutorial covers the setup of a **Project Page**, and as so the `master` branch is used as the source one, and the `gh-pages` branch holds the generated site. However, if you setup a **User Page** then the `master` branch holds the generated site, and so you have to create a new branch (eg: `source`) to hold your site source.

First, create an empty `jekyll-example` repository on github via the web interface.

Then generate the website:
    
    
    $ jekyll new jekyll-example
    

Init git:
    
    
    $ cd jekyll-example
    $ git init
    $ git add .
    $ git commit -m "Generated by Jekyll v2.1.1"
    

Push `master` to github:
    
    
    $ git remote add origin git@github.com:aymerick/jekyll-example.git
    $ git push -u origin master
    

### Setup the gh-pages branch

Create an orphan `gh-pages` branch:
    
    
    $ git checkout --orphan gh-pages
    $ git reset .
    $ rm -r *
    $ rm .gitignore
    $ echo 'Coming soon' > index.html
    $ git add index.html
    $ git commit -m "init"
    

That way the `master` and the `gh-pages` branches are totally independant ones, they share no history at all.

Push `gh-pages` to github:

Now you should see `Coming soon` message when browsing to: <http://aymerick.github.io/jekyll-example/>

### Checkout the gh-pages branch in _dist directory

Let's work in `master` branch:

Checkout the `gh-pages` branch into `_site` directory:

The `_site` directory is already in `.gitignore` so we are just fine.

Let's test our new website:

Browse to <http://127.0.0.1:4000/> and Bingo!

Push the generated site on github:

Now browse to <http://aymerick.github.io/jekyll-example/> and ... wow... the jekyll site is displayed but the CSS is broken. Why ? Because you have to set the `baseurl` setting in the main config file.

So edit the `_config.yml` file and set:

Regenerate the site, and push result on github:

Now browse to <http://aymerick.github.io/jekyll-example/> and everything should be fine.

Let's go back locally:

Note that the local site is now accessible at <http://127.0.0.1:4000/jekyll-example/>

### Disable jekyll build on github

To be sure that jekyll generation is not triggered on github, you must add an empty `.nojekyll` file.

Then edit the `_config.yml` file and set:

### Setup bower

Install bower:

The `bower.json` file should have been created with something like that:

Now, we need to exclude bower files from jekyll build. Edit the `_config.yml` file and adds:

Make git ignore bower components by adding that line to `.gitignore` file:

### Install bootstrap

Let's install [bootstrap](http://getbootstrap.com) with bower:

Now `bootstrap` and `jquery` files are available here:

I really don't want to push the whole `bower_components` directory to github. So let's setup a build system with [grunt](http://gruntjs.com/) that will replace `jekyll` tool and that will copy the vendor files as I want it.

### Setup npm

Init npm:

The `package.json` file should have been created with something like that:

To exclude npm files from jekyll build, edit the `_config.yml` file and adds:

Make git ignore npm packages by adding that line to `.gitignore` file:

### The grunt file

First, install needed grunt packages:

Now the fun part begins, let's create the grunt file. I'm not a big fan of [coffescript](http://coffeescript.org), but for the purpose of a _makefile_ I think its syntax is elegant and cleaner than raw javascript.

So here is the `Gruntfile.coffee` file:

First let's exclude the grunt file from jekyll build, by editing the `_config.yml` file and adding:

### The grunt tasks

The `copy` subtask copies the `jquery` and `bootstrap` files to a new `vendor` directory. That directory will be copied as is by jekyll to `_dist` so it acts as a temporary zone and must be ignored by git. Adds that line to `.gitignore` file:

The `exec:jekyll` subtask invokes the `jekyll` tool to build the site into `_site` directory.

The `connect:server` subtask launches a server on port `4000`.

The `watch` subtask rebuilds the site when a source file changes. The list of all watched source files must be provided in the `files` setting. Remember to update that setting when you add custom directories or files.

Note the use of `livereload: true` in both `watch` and `connect:server` subtasks. Thanks to that setting, your browser will reload automatically when one of the source files changes.

### Include bootstrap files

Let's include `vendor` files in our jekyll site:

Edit the `_includes/head.html` file and add that line:

Edit the `_layouts/default.html` file and add those lines before `</body>`:

### The baseurl dilemma

So now, you can replace the `jekyll serve` command with:

Or if you want verbose logs:

But there is a problem:

  * If you browse to <http://127.0.0.1:4000/jekyll-example> you get a `Cannot GET /jekyll-example/` error
  * If you browse to <http://127.0.0.1:4000/> then the CSS is broken

That's because jekyll is configured with `baseurl: "/jekyll-example"` so that it is browsable at <http://aymerick.github.io/jekyll-example/> but there is no such setting with `grunt-contrib-connect`. The `grunt-contrib-connect` package expects you to browse <http://127.0.0.1:4000/>.

### Custom domain name

I personnally always host my jekyll sites on custom domain names, so I will host that example on <http://jekyll-example.aymerick.com> instead of <http://aymerick.github.io/jekyll-example/>.

That way I don't need a `baseurl` setting and this setup works the same for development and for production. If you really need to keep the `baseurl` setting then you should probably create a new 'production specific' grunt task that will build jekyll with the `\--baseurl URL` option.

So, first you need to comment the `baseurl` setting in the `_config.yml` file:

Then create a `CNAME` file with the custom domain name:

Finally go to your DNS provider website and setup a `CNAME` from `jekyll-example.aymerick.com` to `aymerick.github.io`.

Let's push everything:

And now, browse to <http://jekyll-example.aymerick.com>.

You should probably see a `404 There isn't a GitHub Page here.` error, that's because it takes some time for github to setup your new custom domain configuration. Just wait a few minutes then try again, you will eventually see your site.

### The deploy task

It is tedious to manually commit and push the `gh-pages` branch when you want to deploy to github pages. Let's create a rake task that will help us with that.

Create a `Rakefile` file:

Exclude `Rakefile` from jekyll build, by editing the `_config.yml` file and adding:

And now, deploying your site on github page is as simple as running:

### Conclusion

With that setup, you only have two commands to run:

  * `grunt` while developing, with live reload support
  * `rake deploy` to deploy the site in production

You can now add more bower packages, use custom jekyll plugins, and have fun :)

_(You can contact me [@aymerick](https://twitter.com/aymerick) and I want to thanks [@octplane](https://twitter.com/octplane) for reviewing this tutorial)_
